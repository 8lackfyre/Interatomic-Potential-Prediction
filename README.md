# Interatomic Potential Prediction using Deep Learning

This project trains a deep neural network to predict **interatomic potentials** based on atomic descriptors. It uses **ASE (Atomic Simulation Environment)** for feature extraction and **PyTorch** for training a model.

---

## ğŸ“‚ Project Structure

```
bg-dnn/
â”‚â”€â”€ data/
â”‚   â”œâ”€â”€ dataset.csv           # Training dataset (Generated by run_ase.py)
â”‚   â”œâ”€â”€ test_dataset.csv      # Test dataset (Rename dataset.csv or modify test.py)
â”‚â”€â”€ models/
â”‚   â”œâ”€â”€ interatomic_nn.py     # Neural network model
â”‚â”€â”€ results/
â”‚   â”œâ”€â”€ model_weights.pth     # Saved model weights after training
â”‚â”€â”€ feature_extraction.py     # Computes atomic descriptors
â”‚â”€â”€ interatomic_nn.py         # Defines the deep neural network
â”‚â”€â”€ train.py                  # Trains the model and saves weights
â”‚â”€â”€ test.py                   # Loads model and makes predictions
â”‚â”€â”€ run_ase.py                # Generates synthetic dataset
â”‚â”€â”€ README.md                 # Project documentation
```

---

## ğŸš€ Installation

### **1. Set up Python Virtual Environment**
```bash
python3 -m venv venv
source venv/bin/activate  # On Linux/Mac
venv\Scripts\activate     # On Windows
```

### **2. Install Dependencies**
```bash
pip install numpy pandas torch ase
```

---

## ğŸ›  How It Works

### **1. Feature Extraction (`feature_extraction.py`)**
Extracts atomic **descriptors** (atomic number + neighbor distances).

```python
def compute_descriptors(atoms):
    positions = atoms.get_positions()
    atomic_numbers = atoms.get_atomic_numbers()
    nl = NeighborList([1.5] * len(atoms), self_interaction=False, bothways=True)
    nl.update(atoms)

    descriptors = []
    for i, atom in enumerate(atoms):
        indices, offsets = nl.get_neighbors(i)
        distances = np.linalg.norm(positions[indices] - positions[i], axis=1)
        feature_vector = [atomic_numbers[i]] + list(distances[:5])
        descriptors.append(feature_vector)
    
    return np.array(descriptors)
```

---

### **2. Neural Network Model (`interatomic_nn.py`)**
A **3-layer feedforward neural network** that predicts interatomic potentials.

```python
class InteratomicPotentialNN(nn.Module):
    def __init__(self, input_dim):
        super(InteratomicPotentialNN, self).__init__()
        self.fc1 = nn.Linear(input_dim, 128)
        self.fc2 = nn.Linear(128, 64)
        self.fc3 = nn.Linear(64, 1)  # Output: predicted energy

    def forward(self, x):
        x = torch.relu(self.fc1(x))
        x = torch.relu(self.fc2(x))
        return self.fc3(x)
```

---

### **3. Generate Synthetic Dataset (`run_ase.py`)**
Creates **1000 atomic configurations** with energy labels.

```python
for i in range(1000):
    atoms = Atoms('H2O', positions=np.random.rand(3, 3) * 5)
    atoms.set_calculator(EMT())
    
    atomic_numbers = atoms.get_atomic_numbers()
    positions = atoms.get_positions().flatten()
    energy = atoms.get_potential_energy()
    
    data.append(list(atomic_numbers) + list(positions) + [energy])

df.to_csv("data/dataset.csv", index=False)
print("Synthetic dataset created.")
```

---

### **4. Train Model (`train.py`)**
Trains the model and saves weights.

```bash
python train.py
```

---

### **5. Test Model (`test.py`)**
Loads model weights and makes predictions.

```bash
python test.py
```

---

## â— Common Issues & Fixes

| Issue | Cause | Fix |
|--------|---------|------|
| `FileNotFoundError: results/model_weights.pth` | Model is not trained yet | Run `train.py` first |
| `RuntimeError: size mismatch for fc1.weight` | Model expects `6` features, but dataset has `13` | Update `input_dim=13` in `train.py` and `test.py` |
| `FileNotFoundError: data/test_dataset.csv` | Test dataset is missing | Rename `dataset.csv` or modify `test.py` |

### **Fix for input dimension issue**
Modify `train.py` and `test.py` to use `input_dim=13`:
```python
model = InteratomicPotentialNN(input_dim=13)
```

### **Fix for missing test dataset**
```bash
cp data/dataset.csv data/test_dataset.csv
```

---

## ğŸ“Œ Next Steps
1. Train the model:
   ```bash
   python train.py
   ```
2. Test the model:
   ```bash
   python test.py
   ```
3. Improve feature selection and optimize model performance.

---

## ğŸ“¢ Contributors
- **Bhagyashree Gaikwad** - Project Developer

---
